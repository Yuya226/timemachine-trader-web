# タイムマシン・トレーダー 🎮📈

RPG要素を取り入れた株式トレーニングWebアプリケーション

## コンセプト

- **脱・リアルタイム**: リアルタイムの待ち時間を排除。過去データを「早送り」し、高密度な訓練を行う
- **装備＝知識**: 学習すればするほど、チャート分析機能（武器）がアンロックされる
- **パーソナライズ**: 初期診断でユーザーの投資スタイルを判定し、専用のクラスを決定

## 技術スタック

- **バックエンド**: FastAPI (Python)
- **フロントエンド**: HTMX + Jinja2テンプレート
- **スタイリング**: カスタムCSS（ダークファンタジーテーマ）
- **チャート**: Chart.js
- **セッション管理**: Starlette SessionMiddleware

## 機能

### Phase 1: 転生（初期診断 & クラス決定）

アプリ開始時、5つの質問に答えることで投資家としての「初期クラス」が決定されます：

- **勇者タイプ**: 順張り・長期投資スタイル。王道の成長株狙い
- **盗賊タイプ**: 逆張り・短期投資スタイル。リバウンド狙いの敏捷なトレード
- **賢者タイプ**: ファンダメンタル重視。業績分析メインの堅実投資

### Phase 2: ダンジョン攻略（タイムマシン・トレード）

「銘柄 × 特定期間」＝「ダンジョン」として、過去の相場を体験：

1. **潜入**: 過去の特定日にタイムスリップ
2. **戦闘**: チャートは日足で1日ずつ進む。「Buy / Sell / Wait」を選択
3. **加速**: 「次の日へ」ボタンで高速に時間を進める
4. **決算**: 期間終了後、資産の増減でスコア決定

### Phase 3: 報酬と進化（RPG要素）

ダンジョンクリアで「経験値（XP）」と「ゴールド」を獲得：

- **レベルアップ**: レベルに応じてインジケーター（武器）がアンロック
  - Lv.1: 折れ線グラフ（ひのきの棒）
  - Lv.2: ローソク足チャート（銅の剣）
  - Lv.5: 移動平均線（ホイミの杖）
  - Lv.10: MACD / RSI（メラゾーマの杖 / 氷の剣）
  - Lv.15: ボリンジャーバンド（雷神の槌）

## ダンジョン一覧

| ダンジョン | 難易度 | 推奨レベル | 報酬 |
|-----------|--------|-----------|------|
| 初心者の洞窟 | 初級 | Lv.1+ | 100 XP, 500 G |
| 迷いの森 | 初級 | Lv.2+ | 150 XP, 750 G |
| 試練の山 | 中級 | Lv.5+ | 300 XP, 1,500 G |
| 魔王の城 | 上級 | Lv.10+ | 500 XP, 3,000 G |
| 深淵の迷宮 | 伝説 | Lv.15+ | 1,000 XP, 10,000 G |

## セットアップ

### 必要要件

- Python 3.9+
- pip

### インストール

```bash
cd timemachine-trader-web
pip install fastapi uvicorn jinja2 python-multipart itsdangerous
```

### 起動

```bash
python -m uvicorn main:app --host 0.0.0.0 --port 8080 --reload
```

ブラウザで `http://localhost:8080` にアクセス

## プロジェクト構造

```
timemachine-trader-web/
├── main.py              # FastAPIアプリケーション
├── models.py            # データモデルとゲームロジック
├── static/
│   └── css/
│       └── style.css    # スタイルシート
└── templates/
    ├── base.html        # ベーステンプレート
    ├── index.html       # トップページ
    ├── onboarding.html  # 初期診断
    ├── result.html      # クラス決定結果
    ├── home.html        # ホーム（ギルド）
    ├── dungeons.html    # ダンジョン選択
    ├── dungeon.html     # ダンジョン攻略
    ├── dungeon_result.html  # ダンジョン結果
    ├── equipment.html   # 装備管理
    ├── profile.html     # プロフィール
    └── partials/
        ├── question.html    # 質問パーシャル
        ├── game_panel.html  # ゲームパネル
        └── equipment_list.html  # 装備リスト
```

## ライセンス

MIT License
